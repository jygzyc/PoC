package fun.lilac.exploit.fuzz;

import android.util.Log;

import com.elvishew.xlog.XLog;

import java.util.ArrayList;
import java.util.List;

import fun.lilac.exploit.interfaces.BinderFuzzInterfaces;
import fun.lilac.exploit.utils.SerivceUtil;
import fun.lilac.exploit.utils.ServiceInfo;
import fun.lilac.exploit.utils.XLogUtil;

public class BinderFuzz implements BinderFuzzInterfaces {
    private static final String TAG = "BinderFuzz";

    public BinderFuzz(){
        XLogUtil.initXLog(TAG);
    }


    @Override
    public void Fuzz(ServiceInfo serviceInfo, Boolean sleep) {

    }

    @Override
    public void addBlackListService(String serviceName, int code) {

    }

    @Override
    public List<ServiceInfo> getServiceInfoList() {
        List<ServiceInfo> serviceInfoList = new ArrayList<>();
        try{
            new Thread(new Runnable() {
                @Override
                public void run() {
                    String[] serviceNameList = SerivceUtil.getServiceNameList();
                    for (String serviceName : serviceNameList) {
                        if (serviceName == null) {
                            continue;
                        } else {
                            serviceInfoList.add(SerivceUtil.getServiceInfo(serviceName));
                            XLog.e("Service %s added!", serviceName);
                        }
                    }
                }
            }).start();
        }catch (Exception e){
            e.printStackTrace();
        }
        return serviceInfoList;
    }
}
